@model DocumentDevelopment.ViewModels.DocumentData
@using DocumentDevelopment.Helpers;

<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    @{ await Html.RenderPartialAsync("DocumentStyle"); }

</head>

<body class="main-content">
    <div class="section section-full">
        <img class="logo" src="https://gastag.s3-eu-west-1.amazonaws.com/RefImages/Emails/Logo-plus-Tagline.png" />
        <h1 class="title">
            Certificate of Chimney Sweeping <span class="sub_heading">(Landlord Safety Certificate)</span>
        </h1>
        <p class="description">
            This record is for safety purposes only. This report is vaild for the day of assessment
            only.
        </p>
    </div>

    <div class="section section-half">
        <h2 class="section-header">Engineer Details</h2>
        <table class="question-table" cellspacing=0>
            <tr>
                <td class="question">
                    Engineer Name:
                </td>
                <td class="answer">
                    @(Model.Engineer.FirstName + " " + Model.Engineer.LastName)
                </td>
                <td class="question">
                    Company Name:
                </td>
                <td class="answer">
                    @Model.Company.CompanyName
                </td>
            </tr>
            <tr>
                <td class="question">
                    Address:
                </td>
                <td class="answer" colspan="3">
                    @Model.Company.Address.AddressOne<br />
                    @Model.Company.Address.AddressTwo<br />
                    @Model.Company.Address.City<br />
                    @Model.Company.Address.Postcode
                </td>
            </tr>
        </table>
    </div>

    <div class="section section-quarter">
        <div class="section-border" style="height: 82px;">
            <h2 class="section-header no-margin">Sweeping Address</h2>
            @Model.Property.Address.AddressOne<br />
            @Model.Property.Address.AddressTwo<br />
            @Model.Property.Address.City<br />
            @Model.Property.Address.Postcode
        </div>
    </div>

    <div class="section section-quarter">
        <div class="section-border" style="height: 82px;">
            <h2 class="section-header no-margin">Landlord Address</h2>
            @Model.Landlord.Address.AddressOne<br />
            @Model.Landlord.Address.AddressTwo<br />
            @Model.Landlord.Address.City<br />
            @Model.Landlord.Address.Postcode
        </div>
    </div>

    <div class="section section-twothird">
        <table class="repeater-question-table" cellspacing=0>
            <thead>
                <tr>
                    <th class="spacing-header"></th>
                    @for (var x = 1; x <= Model.Chimneys.Count(); x++)
                    {
                        <th>Chimney @x</th>
                    }
                </tr>
            </thead>
        </table>

        <h2 class="section-header">Appliance Details</h2>
        <table class="question-table" cellspacing=0>
            <tr>
                <td class="question" colspan="3">
                    Location
                </td>
                @foreach (var chimney in Model.Chimneys)
                {
                    <td class="answer" colspan="2">
                        @chimney.ApplianceLocation
                    </td>
                }
            </tr>
            <tr>
                <td class="question" colspan="3">
                    Description
                </td>
                @foreach (var chimney in Model.Chimneys)
                {
                    <td class="answer" colspan="2">

                        @chimney.Make<br />
                        @chimney.Model

                    </td>
                }
            </tr>
            <tr>
                <td class="question" colspan="3">
                    Fuel Type
                </td>
                @foreach (var chimney in Model.Chimneys)
                {
                    <td class="answer" colspan="2">
                        @chimney.Payload.GetValue("E_FuelType")
                    </td>
                }
            </tr>
        </table>

        <h2 class="section-header">Visual Inspection</h2>
        <table class="question-table" cellspacing=0>
            <tr>
                <td class="question" colspan="3">
                    Flue
                </td>
                @foreach (var chimney in Model.Chimneys)
                {
                    <td class="answer" colspan="2">
                        @chimney.Answers.GetValue("E_FlueResult")
                    </td>
                }
            </tr>
            <tr>
                <td class="question" colspan="3">
                    Stack
                </td>
                @foreach (var chimney in Model.Chimneys)
                {
                    <td class="answer" colspan="2">
                        @chimney.Answers.GetValue("E_StackResult")
                    </td>
                }
            </tr>
            <tr>
                <td class="question" colspan="3">
                    Pot
                </td>
                @foreach (var chimney in Model.Chimneys)
                {
                    <td class="answer" colspan="2">
                        @chimney.Answers.GetValue("E_PotResult")
                    </td>
                }
            </tr>
            <tr>
                <td class="question" colspan="3">
                    Cowl
                </td>
                @foreach (var chimney in Model.Chimneys)
                {
                    <td class="answer" colspan="2">
                        @chimney.Answers.GetValue("E_CowlResult")
                    </td>
                }
            </tr>
        </table>

        <h2 class="section-header">Tests / Observations</h2>
        <table class="question-table" cellspacing=0>
            <tr>
                <td class="question" colspan="3">
                    Deposits Removed
                </td>
                @foreach (var chimney in Model.Chimneys)
                {
                    <td class="answer" colspan="2">
                        @chimney.Answers.GetValue("E_DepositRemoved")
                    </td>
                }
            </tr>
            <tr>
                <td class="question" colspan="3">
                    Deposit Detail
                </td>
                @foreach (var chimney in Model.Chimneys)
                {
                    <td class="answer" colspan="2">
                        @chimney.Answers.GetValue("E_DepositDetail")
                    </td>
                }
            </tr>
            <tr>
                <td class="question" colspan="3">
                    Fire Risk
                </td>
                @foreach (var chimney in Model.Chimneys)
                {
                    <td class="answer" colspan="2">
                        @chimney.Answers.GetValue("E_FireRiskResult")
                    </td>
                }
            </tr>
            <tr>
                <td class="question" colspan="3">
                    Smoke Test Type II (Cold)
                </td>
                @foreach (var chimney in Model.Chimneys)
                {
                    <td class="answer" colspan="2">
                        @chimney.Answers.GetValue("E_SmokeTestTypeTwoResult")
                    </td>
                }
            </tr>
            <tr>
                <td class="question" colspan="3">
                    Ventilation
                </td>
                @foreach (var chimney in Model.Chimneys)
                {
                    <td class="answer" colspan="2">
                        @chimney.Answers.GetValue("E_VentilationResult")
                    </td>
                }
            </tr>
            <tr>
                <td class="question" colspan="3">
                    CCTV Inspection
                </td>
                @foreach (var chimney in Model.Chimneys)
                {
                    <td class="answer" colspan="2">
                        @chimney.Answers.GetValue("E_CCTVInspectionResult")
                    </td>
                }
            </tr>
            <tr>
                <td class="question" colspan="3">
                    Pressure Test
                </td>
                @foreach (var chimney in Model.Chimneys)
                {
                    <td class="answer" colspan="2">
                        @chimney.Answers.GetValue("E_PressureTestResult")
                    </td>
                }
            </tr>
            <tr>
                <td class="question" colspan="3">
                    Sweep Method
                </td>
                @foreach (var chimney in Model.Chimneys)
                {
                    <td class="answer" colspan="2">
                        @chimney.Answers.GetValue("E_SweepMethod")
                    </td>
                }
            </tr>
            <tr>
                <td class="question" colspan="3">
                    Next Sweep Date
                </td>
                @foreach (var chimney in Model.Chimneys)
                {
                    <td class="answer" colspan="2">
                        @chimney.NextSweepDate.ToString("yyyy-MM-dd")
                    </td>
                }
            </tr>
            <tr>
                <td class="question" colspan="3">
                    Warning Notice Issued?
                </td>
                @foreach (var chimney in Model.Chimneys)
                {
                    <td class="answer" colspan="2">
                        @chimney.Answers.GetValue("E_UnsafeProcedureRequiredResult")
                    </td>
                }
            </tr>
        </table>
    </div>

    <div class="section section-third">
        <div class="section-border">
            <h2 class="section-header no-margin">Defects Identified</h2>
            <table class="question-table" cellspacing=0>
                @foreach (var defect in Model.Defects)
                {
                    <tr>
                        <td class="question-prefix repeater">
                            @defect.Order
                        </td>
                        <td class="answer" colspan="19">
                            @defect.Defect
                        </td>
                    </tr>
                }
            </table>
        </div>

        <div class="section-border">
            <h2 class="section-header no-margin">Remedial Recommendations</h2>
            <table class="question-table" cellspacing=0>
                @foreach (var defect in Model.Defects)
                {
                    <tr>
                        <td class="question-prefix repeater">
                            @defect.Order
                        </td>
                        <td class="answer" colspan="19">
                            @defect.Recommendation
                        </td>
                    </tr>
                }
            </table>
        </div>


        <h2 class="section-header">Servicing Record Sign Off</h2>
        <table class="question-table" cellspacing=0>
            <tr>
                <td class="question-prefix" rowspan="3" colspan="3">
                    Issued by:
                </td>
                <td class="question" colspan="2">
                    Signed:
                </td>
                <td class="answer" colspan="4" height=40>
                    <img src="data:image/png;base64, @Model.EngineerSignatureImage" alt="" height="30">
                </td>
            </tr>
            <tr>
                <td class="question" colspan="2">
                    Print Name:
                </td>
                <td class="answer" colspan="4">
                    @(Model.Engineer.FirstName + " " + Model.Engineer.LastName)
                </td>
            </tr>
            <tr>
                <td class="question" colspan="2">
                    Date:
                </td>
                <td class="answer" colspan="4">
                    @DateTime.Now.ToString("yyyy-MM-dd")
                </td>
            </tr>
            <tr>
                <td class="question-prefix" rowspan="3" colspan="3" style="border-bottom-left-radius: 10px;">
                    Customer Confirmation:
                </td>
                <td class="question" colspan="2">
                    Signed:
                </td>
                <td class="answer" colspan="4" height=40>
                    <img src="data:image/png;base64, @Model.TenantSignatureImage" alt="" height="30">
                </td>
            </tr>
            <tr>
                <td class="question" colspan="2">
                    Print Name:
                </td>
                <td class="answer" colspan="4">
                    @Model.Answers.GetValue("E_PrintName")
                </td>
            </tr>
            <tr>
                <td class="question" colspan="2">
                    Date:
                </td>
                <td class="answer" colspan="4" style="border-bottom-right-radius: 10px;">
                    @Model.JobDate.ToString("yyyy-MM-dd")
                </td>
            </tr>
        </table>
    </div>
</body>

</html>