@model DocumentDevelopment.ViewModels.DocumentData
@using DocumentDevelopment.Helpers;

<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    @{ await Html.RenderPartialAsync("DocumentStyle"); }

</head>

<body class="main-content">
    <div class="section section-full">
        <img class="logo" src="https://gastag.s3-eu-west-1.amazonaws.com/RefImages/Emails/Logo-plus-Tagline.png" />
        <h1 class="title">
            Annual Solar Thermal Equipment Service
        </h1>
        <p class="description">
            Please note where gas is used as a primary or secondary source to heat the hot water this
            document does not eliminate the requirement for a seperate Landlord's Gas Safety
            Record (LGSR) to be completed.
        </p>
    </div>

    <div class="section section-third">
        <h2 class="section-header">Customer Details</h2>
        <table class="question-table" cellspacing=0>
            <tr>
                <td class="question">
                    Name
                </td>
                <td class="answer" colspan="2">
                    @Model.Answers.GetValue("E_PrintName")
                </td>
            </tr>
            <tr>
                <td class="question">
                    Address
                </td>
                <td class="answer" colspan="2" style="height: 60px;">

                    @(Model.Property.Address.AddressOne + " " + Model.Property.Address.AddressTwo)<br />
                    @(Model.Property.Address.City + " " + Model.Property.Address.Postcode)

                </td>
            </tr>
        </table>
    </div>

    <div class="section section-third">
        <h2 class="section-header">Landlord Details</h2>
        <table class="question-table" cellspacing=0>
            <tr>
                <td class="question">
                    Landlord Name
                </td>
                <td class="answer" colspan="2">
                    @Model.Landlord.Name
                </td>
            </tr>
            <tr>
                <td class="question">
                    Address
                </td>
                <td class="answer" colspan="2" style="height: 60px;">

                    @(Model.Landlord.Address.AddressOne + " " + Model.Landlord.Address.AddressTwo)<br />
                    @(Model.Landlord.Address.City + " " + Model.Landlord.Address.Postcode)

                </td>
            </tr>
        </table>
    </div>

    <div class="section section-third">
        <h2 class="section-header">Company & Engineer Details</h2>
        <table class="question-table" cellspacing=0>
            <tr>
                <td class="question">
                    Company Name
                </td>
                <td class="answer" colspan="2">
                    @Model.Company.CompanyName
                </td>
            </tr>
            <tr>
                <td class="question">
                    Company Address
                </td>
                <td class="answer" colspan="2" style="height: 40px;">

                    @(Model.Company.Address.AddressOne + " " + Model.Company.Address.AddressTwo)<br />
                    @(Model.Company.Address.City + " " + Model.Company.Address.Postcode)

                </td>
            </tr>
            <tr>
                <td class="question">
                    Engineer Name
                </td>
                <td class="answer" colspan="2">
                    @(Model.Engineer.FirstName + " " + Model.Engineer.LastName)
                </td>
            </tr>
        </table>
    </div>

    <div class="section section-half">
        <h2 class="section-header">Equipment Details</h2>
        <table class="question-table" cellspacing=0>
            <tr>
                <td class="question" colspan="3">
                    System Type
                </td>
                <td class="answer" colspan="12">
                    @Model.Appliance.Payload.GetValue("E_SystemType")
                </td>
            </tr>
            <tr>
                <td class="question" colspan="3">
                    Cylinder Make
                </td>
                <td class="answer" colspan="5">
                    @Model.Appliance.Payload.GetValue("E_CylinderMake")
                </td>
                <td class="question" colspan="3">
                    Cylinder Model
                </td>
                <td class="answer" colspan="4">
                    @Model.Appliance.Payload.GetValue("E_CylinderModel")
                </td>
            </tr>
            <tr>
                <td class="question" colspan="3">
                    Cylinder S/N
                </td>
                <td class="answer" colspan="2">
                    @Model.Appliance.Payload.GetValue("E_CylinderSerialNumber")
                </td>
                <td class="question" colspan="3">
                    Cylinder Type
                </td>
                <td class="answer" colspan="2">
                    @Model.Appliance.Payload.GetValue("E_CylinderType")
                </td>
                <td class="question" colspan="3">
                    Cylinder Size
                </td>
                <td class="answer" colspan="2">
                    @Model.Appliance.Payload.GetValue("E_CylinderSize")<span class="units">Ltrs</span>
                </td>
            </tr>
            <tr>
                <td class="question" colspan="3">
                    Collector Make
                </td>
                <td class="answer" colspan="5">
                    @Model.Appliance.Payload.GetValue("E_CollectorMake")
                </td>
                <td class="question" colspan="3">
                    Collector Model
                </td>
                <td class="answer" colspan="4">
                    @Model.Appliance.Payload.GetValue("E_CollectorModel")
                </td>
            </tr>
            <tr>
                <td class="question" colspan="3">
                    Collector S/N
                </td>
                <td class="answer" colspan="2">
                    @Model.Appliance.Payload.GetValue("E_CollectorSerialNumber")
                </td>
                <td class="question" colspan="3">
                    Collector Type
                </td>
                <td class="answer" colspan="2">
                    @Model.Appliance.Payload.GetValue("E_CollectorType")
                </td>
                <td class="question" colspan="3">
                    No. of Collectors
                </td>
                <td class="answer" colspan="2">
                    @Model.Appliance.Payload.GetValue("E_NumberOfCollectors")
                </td>
            </tr>
            <tr>
                <td class="question" colspan="3">
                    Pump Station Make
                </td>
                <td class="answer" colspan="5">
                    @Model.Appliance.Payload.GetValue("E_PumpStationMake")
                </td>
                <td class="question" colspan="3">
                    Pump Station Model
                </td>
                <td class="answer" colspan="4">
                    @Model.Appliance.Payload.GetValue("E_PumpStationModel")
                </td>
            </tr>
            <tr>
                <td class="question" colspan="3">
                    Pump Station S/N
                </td>
                <td class="answer" colspan="5">
                    @Model.Appliance.Payload.GetValue("E_PumpStationSerialNumber")
                </td>
                <td class="question" colspan="3">
                    No. of Pumps
                </td>
                <td class="answer" colspan="4">
                    @Model.Appliance.Payload.GetValue("E_NumberOfPumps")
                </td>
            </tr>
            <tr>
                <td class="question" colspan="3">
                    Drain Back Tank Make
                </td>
                <td class="answer" colspan="2">
                    @Model.Appliance.Payload.GetValue("E_DrainBackTankMake")
                </td>
                <td class="question" colspan="3">
                    Drain Back Tank Model
                </td>
                <td class="answer" colspan="2">
                    @Model.Appliance.Payload.GetValue("E_DrainBackTankModel")
                </td>
                <td class="question" colspan="3">
                    Drain Back Tank S/N
                </td>
                <td class="answer" colspan="2">
                    @Model.Appliance.Payload.GetValue("E_DrainBackTankSerialNumber")
                </td>
            </tr>
            <tr>
                <td class="question" colspan="3">
                    Expansion Vessel Size
                </td>
                <td class="answer" colspan="5">
                    @Model.Appliance.Payload.GetValue("E_ExpansionVesselSize")<span class="units">Ltrs</span>
                </td>
                <td class="question" colspan="3">
                    Expansion Pre Charge Setting
                </td>
                <td class="answer" colspan="4">
                    @Model.Appliance.Payload.GetValue("E_ExVesselPreChargeSetting") <span class="units">bar</span>
                </td>
            </tr>
            <tr>
                <td class="question" colspan="4">
                    Appliance Condition
                </td>
                <td class="answer" colspan="4">
                    @Model.Appliance.Payload.GetValue("E_ApplianceCondition")
                </td>
                <td class="question" colspan="4">
                    Landlord's Appliance
                </td>
                <td class="answer" colspan="3">
                    @Model.Appliance.Payload.GetValue("E_LandlordsAppliance")
                </td>
            </tr>
        </table>

        @{ await Html.RenderPartialAsync("DefectsSection"); }

        @{ await Html.RenderPartialAsync("SignOffSection"); }
    </div>

    <div class="section section-half">
        <h2 class="section-header">Solar System Checks</h2>
        <table class="question-table" cellspacing=0>
            <tr>
                <td class="question" colspan="3">
                    Initial System Pressure (ISP)
                </td>
                <td class="answer">
                    @Model.Answers.GetValue("E_InitialSystemPressure")<span class="units">bar</span>
                </td>
                <td class="question" colspan="3">
                    Is ISP Correct?
                </td>
                <td class="answer">
                    @Model.Answers.GetValue("E_InitialSystemPressureCorrectResult")
                </td>
            </tr>
            <tr>
                <td class="question" colspan="3">
                    Condition of Collectors & Ancillaries
                </td>
                <td class="answer">
                    @Model.Answers.GetValue("E_CollectorsVisualConditionResult")
                </td>
                <td class="question" colspan="3">
                    Check frost protection of Solar Fluid
                </td>
                <td class="answer">
                    @Model.Answers.GetValue("E_SolarFluidFrostProtectionResult")
                </td>
            </tr>
            <tr>
                <td class="question" colspan="3">
                    Solar Fluid Refractometer Reading
                </td>
                <td class="answer">
                    @Model.Answers.GetValue("E_SolarFluidRefractometerReading")
                </td>
                <td class="question" colspan="3">
                    Pressure Relief Valve (PRV) Solar Rated
                </td>
                <td class="answer">
                    @Model.Answers.GetValue("E_PressureReliefValveRatedResult")
                </td>
            </tr>
            <tr>
                <td class="question" colspan="3">
                    PRV Operational
                </td>
                <td class="answer">
                    @Model.Answers.GetValue("E_PressureReliefValveOperationalResult")
                </td>
                <td class="question" colspan="3">
                    Discharge Container
                </td>
                <td class="answer">
                    @Model.Answers.GetValue("E_SuitablySizedDischargeContainerResult")
                </td>
            </tr>
            <tr>
                <td class="question" colspan="3">
                    Checked Discharge Container Fluid
                </td>
                <td class="answer">
                    @Model.Answers.GetValue("E_CheckedDischargeContainerFluidResult")
                </td>
                <td class="question" colspan="3">
                    Automatic Air Vents
                </td>
                <td class="answer">
                    @Model.Answers.GetValue("E_AutoAirVentsServiceableResult")
                </td>
            </tr>
            <tr>
                <td class="question" colspan="3">
                    Filling Point
                </td>
                <td class="answer">
                    @Model.Answers.GetValue("E_SuitableFillingPointResult")
                </td>
                <td class="question" colspan="3">
                    Drain Point
                </td>
                <td class="answer">
                    @Model.Answers.GetValue("E_SuitableDrainPointFittedResult")
                </td>
            </tr>
            <tr>
                <td class="question" colspan="3">
                    Isolation and Check Valves
                </td>
                <td class="answer">
                    @Model.Answers.GetValue("E_IsolationValvesFittedCorrectlyResult")
                </td>
                <td class="question" colspan="3">
                    Pressure Gauge
                </td>
                <td class="answer">
                    @Model.Answers.GetValue("E_PressureGaugeFittedResult")
                </td>
            </tr>
            <tr>
                <td class="question" colspan="3">
                    Solar Pipework Condition
                </td>
                <td class="answer">
                    @Model.Answers.GetValue("E_SolarPipeworkSoundSupportedResult")
                </td>
                <td class="question" colspan="3">
                    Solar Pipework Insulation
                </td>
                <td class="answer">
                    @Model.Answers.GetValue("E_SolarPipeworkProtectedResult")
                </td>
            </tr>
            <tr>
                <td class="question" colspan="3">
                    All Components are Steam/Solar Rated?
                </td>
                <td class="answer">
                    @Model.Answers.GetValue("E_ComponentsSteamSolarRatedResult")
                </td>
                <td class="question" colspan="3">
                    Collector Sensors
                </td>
                <td class="answer">
                    @Model.Answers.GetValue("E_CollectorSensorsSecureResult")
                </td>
            </tr>
            <tr>
                <td class="question" colspan="3">
                    Storage Vessel/Cylinder
                </td>
                <td class="answer">
                    @Model.Answers.GetValue("E_VesselSensorsSecureResult")
                </td>
                <td class="question" colspan="3">
                    Charge Pressure
                </td>
                <td class="answer">
                    @Model.Answers.GetValue("E_ChargePressureExVessel")<span class="units">bar</span>
                </td>
            </tr>
            <tr>
                <td class="question" colspan="3">
                    Solar Fluid topped up?
                </td>
                <td class="answer">
                    @Model.Answers.GetValue("E_ToppedUpSolarFluidResult")
                </td>
                <td class="question" colspan="3">
                    System Pressure
                </td>
                <td class="answer">
                    @Model.Answers.GetValue("E_SystemPressure")<span class="units">bar</span>
                </td>
            </tr>
            <tr>
                <td class="question" colspan="3">
                    Solar Pump/s
                </td>
                <td class="answer">
                    @Model.Answers.GetValue("E_SolarPumpCorrectSpeedResult")
                </td>
                <td class="question" colspan="3">
                    Solar Flow Rate Setting
                </td>
                <td class="answer">
                    @Model.Answers.GetValue("E_SolarFlowRate")<span class="units">Ltrs</span>
                </td>
            </tr>
            <tr>
                <td class="question" colspan="3">
                    NTCs Operational
                </td>
                <td class="answer">
                    @Model.Answers.GetValue("E_NTCOperatingCorrectlyResult")
                </td>
                <td class="question" colspan="3">
                    Controls
                </td>
                <td class="answer">
                    @Model.Answers.GetValue("E_ControlsWithinManufacturerSpecResult")
                </td>
            </tr>
            <tr>
                <td class="question" colspan="3">
                    Sizing of Collectors & Cylinder
                </td>
                <td class="answer">
                    @Model.Answers.GetValue("E_CollectorsCorrectlySizedResult")
                </td>
                <td class="question" colspan="3">
                    DHW Blending Valve
                </td>
                <td class="answer">
                    @Model.Answers.GetValue("E_DHWBlendingValveInstalledResult")
                </td>
            </tr>
            <tr>
                <td class="question" colspan="3">
                    DHW Outlet Temperature
                </td>
                <td class="answer">
                    @Model.Answers.GetValue("E_DHWOutletTemp")<span class="units">&deg;C</span>
                </td>
                <td class="question" colspan="3">
                    Acceptable Range?
                </td>
                <td class="answer">
                    @Model.Answers.GetValue("E_DHWOutletTempAcceptableResult")
                </td>
            </tr>
            <tr>
                <td class="question" colspan="3">
                    Secondary Heat Source been Interlocked?
                </td>
                <td class="answer">
                    @Model.Answers.GetValue("E_SecondaryHeatSourceInterlockedResult")
                </td>
                <td class="question" colspan="3">
                    Electrical Connections Sound & Cables Clipped & Protected
                </td>
                <td class="answer">
                    @Model.Answers.GetValue("E_ConnectionsSoundAndProtectedResult")
                </td>
            </tr>
            <tr>
                <td class="question" colspan="7">
                    Condition
                </td>
                <td class="answer">
                    @Model.Answers.GetValue("E_SolarCondition")
                </td>
            </tr>
            <tr>
                <td class="question" colspan="7">
                    Is the Solar Appliance Safe to Use?
                </td>
                <td class="answer">
                    @Model.Answers.GetValue("E_SolarSafeToUseResult")
                </td>
            </tr>
            <tr>
                <td class="question" colspan="7">
                    Have you Isolated the Pump Station?
                </td>
                <td class="answer">
                    @Model.Answers.GetValue("E_IsolatedPumpStationResult")
                </td>
            </tr>
            <tr>
                <td class="question" colspan="7">
                    Defects Identified?
                </td>
                <td class="answer">
                    @(Model.Defects.Any() ? "Yes" : "No")
                </td>
            </tr>
            <tr>
                <td class="question" colspan="7">
                    Warning Notice / Unsafe Situation Procedure Required?
                </td>
                <td class="answer">
                    @Model.Answers.GetValue("E_WarningNoticeRequiredResult")
                </td>
            </tr>
        </table>
    </div>
</body>

</html>